<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: chef | Timeline]]></title>
  <link href="http://www.ahwkong.com/post/categories/chef/atom.xml" rel="self"/>
  <link href="http://www.ahwkong.com/"/>
  <updated>2015-02-11T05:27:31+11:00</updated>
  <id>http://www.ahwkong.com/</id>
  <author>
    <name><![CDATA[Anthony Kong]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Providing mysqld password to chef provisioner in vagrant]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/11/mysqld-password-and-chef/"/>
    <updated>2015-02-11T05:04:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/11/mysqld-password-and-chef</id>
    <content type="html"><![CDATA[<p>I add a chef <code>mysqld</code> receipt to the Vagrant file and here is the error from <code>vagrant up</code>:</p>

<pre><code>    ==&gt; default: Required argument password is missing!
    ==&gt; default:
    ==&gt; default: Cookbook Trace:
    ==&gt; default: ---------------
    ==&gt; default:   /tmp/vagrant-chef/3aa2e36871bb373e4212367ce1b7d9af/cookbooks/mysqld/recipes/configure.rb:26:in `block in from_file'
    ==&gt; default:   /tmp/vagrant-chef/3aa2e36871bb373e4212367ce1b7d9af/cookbooks/mysqld/recipes/configure.rb:25:in `from_file'
    ==&gt; default:   /tmp/vagrant-chef/3aa2e36871bb373e4212367ce1b7d9af/cookbooks/mysqld/recipes/default.rb:22:in `from_file'
    ==&gt; default:
    ==&gt; default: Relevant File Content:
    ==&gt; default: ----------------------
    ==&gt; default: /tmp/vagrant-chef/3aa2e36871bb373e4212367ce1b7d9af/cookbooks/mysqld/recipes/configure.rb:
    ==&gt; default:
    ==&gt; default:  19:  #
    ==&gt; default:  20:
    ==&gt; default:
    ==&gt; default:  21:  # Configure mysql/mariadb according to attributes
    ==&gt; default:  22:  mysqld 'default'
    ==&gt; default:  23:
    ==&gt; default:  24:  # Set password according to attribute, if set
    ==&gt; default:  25:  mysqld_password 'root' do
    ==&gt; default:  26&gt;&gt;   password node['mysqld']['root_password']
    ==&gt; default:
    ==&gt; default:  27:    only_if { node['mysqld']['root_password'] }
    ==&gt; default:  28:  end
    ==&gt; default:  29:
</code></pre>

<p>Solution: Add this to set the <code>root_password</code>:</p>

<pre><code>chef.json = {
  :mysqld   =&gt; {
    :root_password =&gt; "test"
  }
}
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Cannot find a resource matching ruby_block[sensu_service_trigger]]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/08/cannot-find-a-resource-matching-ruby-block-sensu-service-trigger/"/>
    <updated>2015-02-08T18:26:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/08/cannot-find-a-resource-matching-ruby-block-sensu-service-trigger</id>
    <content type="html"><![CDATA[<p>This the error message:</p>

<pre><code>    ==&gt; default: ================================================================================
    ==&gt; default: Error executing action `enable` on resource 'sensu_service[sensu-client]'
    ==&gt; default: ================================================================================
    ==&gt; default:
    ==&gt; default: Chef::Exceptions::ResourceNotFound
    ==&gt; default: ----------------------------------
    ==&gt; default: Cannot find a resource matching ruby_block[sensu_service_trigger] (did you define it first?)
    ==&gt; default:
    ==&gt; default: Cookbook Trace:
    ==&gt; default: ---------------
    ==&gt; default: /tmp/vagrant-chef/c66d06dac7e6e1e4d559122d4d1a9f5c/cookbooks/sensu/providers/service.rb:52:in `block in load_current_resource'
</code></pre>

<p>It is because I did not include the <code>sensu::default</code> cookbook.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ochiwa unable to connect to sensu]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/06/ochiwa-unable-to-connect-to-sensu/"/>
    <updated>2015-02-06T05:13:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/06/ochiwa-unable-to-connect-to-sensu</id>
    <content type="html"><![CDATA[<p>I used chef to install sensu and ochiwa.</p>

<p>In the ocihwa log I see a lot of &lsquo;connection refused&rsquo; error</p>

<pre><code>{"Date":"2015-02-05T09:42:23.516606749Z","Level":"warning","Src":{"Func":"github.com/sensu/uchiwa/uchiwa.Build","Line":49},"Output":"API call to \"http://127.0.0.1:4567/stashes\" returned: Get http://127.0.0.1:4567/stashes: dial tcp 127.0.0.1:4567: connection refused"}
</code></pre>

<p>With help from sensu irc chatroom, I checked</p>

<pre><code>netstat -anp | grep 4567
</code></pre>

<p>There is no process.</p>

<pre><code>service sensu-api status
</code></pre>

<p>The service is stopped.</p>

<p>After starting the service, ochiwa can talk to sensu server now.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Update ChefDK in OSX]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/04/update-chefdk-in-osx/"/>
    <updated>2015-02-04T09:08:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/04/update-chefdk-in-osx</id>
    <content type="html"><![CDATA[<p>A new version of ChefDK 0.4.0 has been released. I did an upgrade via <code>brew cask</code></p>

<pre><code>    $ brew update
    ...
    $ brew cask install --force chefdk
    ==&gt; Downloading https://opscode-omnibus-packages.s3.amazonaws.com/mac_os_x/10.8/x86_64/chefdk-0.4.0-1.dmg
    ######################################################################## 100.0%
    ==&gt; Running installer for chefdk; your password may be necessary.
    ==&gt; Package installers may write to any location; options such as --appdir are ignored.
    Password:
    ==&gt; installer: Package name is Chef Development Kit
    ==&gt; installer: Upgrading at base path /
    ==&gt; installer: The upgrade was successful.
    üç∫  chefdk staged at '/opt/homebrew-cask/Caskroom/chefdk/0.4.0-1' (6 files, 99M)
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[chef, brekshelf and data bag]]></title>
    <link href="http://www.ahwkong.com/post/2015/01/20/chef/"/>
    <updated>2015-01-20T14:41:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/01/20/chef</id>
    <content type="html"><![CDATA[<p>After some trial and errors, the best way (as of this writing) to manage cookbooks for <strong>vagrant</strong> + <strong>chef</strong> is to use brekshef. You can forget about <code>knife</code> or <code>librarian-chef</code>.</p>

<p>If you use berkshelf with vagrant, you will need to install the vagrant-berkshelf plugin. The plugin is quite clever and you do not need to specify the cookbook path for your chef-solo or chef-zero provisioner.</p>

<p>However it does not apply to <code>data_bags</code>. You will still need to specify the path to <code>data_bags</code> if you need to use data bag.</p>
]]></content>
  </entry>
  
</feed>

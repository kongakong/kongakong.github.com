
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Timeline</title>
  <meta name="author" content="Anthony Kong">

  
  <meta name="description" content="The problem is this: vagrant failed to provision a box after it is successfully created in aws ec2. It reported: INFO ssh: SSH not up: #&lt;Vagrant:: &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.ahwkong.com/post/page/5">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Timeline" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>

<!-- Start of StatCounter Code for Netscape Composer -->
<script type="text/javascript">
var sc_project=9614190; 
var sc_invisible=1; 
var sc_security="867743ed"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="hit counter"
href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="http://c.statcounter.com/9614190/0/867743ed/1/"
alt="hit counter"></a></div></noscript>
<!-- End of StatCounter Code for Netscape Composer -->

  

  <!-- add table css  -->
  <link href="/stylesheets/custom/table.css" media="screen, projection" rel="stylesheet" type="text/css" />

</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Timeline</a></h1>
  
    <h2>My development logbook</h2>
  
</hgroup>


</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.ahwkong.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-33727381-1', 'auto');
  ga('send', 'pageview');

</script>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- HeaderMainBlog --> 
<p>
<div>
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-8982189898976576"
     data-ad-slot="5004928679"></ins>
</div>
</p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/post/2015/02/19/cannot-let-private-and-public-key-sit-in-the-same-folder-when-vagrant-up/">Don&#8217;t Let Private and Public Key Sit in the Same Folder When Vagrant Up</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-19T16:39:00+11:00" pubdate data-updated="true">Feb 19<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The problem is this:</p>

<p><strong><code>vagrant</code> failed to provision a box after it is successfully created in aws ec2.</strong></p>

<p>It reported:</p>

<pre><code>     INFO ssh: SSH not up: #&lt;Vagrant::Errors::SSHAuthenticationFailed: SSH authentication failed! This is typically caused by the public/private
     keypair for the SSH user not being properly set on the guest VM. Please
     verify that the guest VM is setup with the proper public key, and that
     the private key path for Vagrant is setup properly as well.&gt;
</code></pre>

<p>But if I do <code>vagrant ssh</code> I can login to the box with no problem.</p>

<p>I have tried everything to get it to work. I have removed <code>rvm</code>, I have reinstalled <code>chefdk</code>, I have downgraded <code>vagrant</code>&hellip; None of them work.</p>

<p>I studied the log message a bit closer and I found these lines:</p>

<pre><code>     769 D, [2015-02-19T15:05:43.563478 #14537] DEBUG -- net.ssh.authentication.session[851208b0]: allowed methods: publickey
     770 D, [2015-02-19T15:05:43.563564 #14537] DEBUG -- net.ssh.authentication.methods.none[85125400]: none failed
     771 D, [2015-02-19T15:05:43.563650 #14537] DEBUG -- net.ssh.authentication.session[851208b0]: trying publickey
     772 E, [2015-02-19T15:05:43.564057 #14537] ERROR -- net.ssh.authentication.key_manager[851256d0]: could not load public key file `/Users/antkong/dev/project/aws/aws-ami.pem': Net::SSH::Exception (public key at /Users/antkong/dev/project/aws/aws-ami.pem.pub is not valid)
</code></pre>

<p>Apparently for some reason the key manager picked the public key file to connect to the server: I have specified a private key file in the <code>Vagrantfile</code>. The key manager added &lsquo;.pub&rsquo; to the file name and pick the file up.</p>

<p>Removing the public key file solved the issue.</p>

<p><strong>Lesson</strong>: Don&rsquo;t put the public key along with the private key.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/post/2015/02/18/chsh/">Chsh</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-18T05:22:00+11:00" pubdate data-updated="true">Feb 18<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Unable to switch to zsh which is installed from brew</p>

<pre><code>    $ chsh -s `which zsh`
    Changing shell for demo.
    Password for demo:
    chsh: /usr/local/bin/zsh: non-standard shell
</code></pre>

<p>Solution:</p>

<p>Add <code>/usr/local/bin/zsh</code> to <code>/etc/shells</code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/post/2015/02/17/aws-dynamo-exception-400-bad-request/">AWS Dynamo Exception: 400 Bad Request</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-17T15:14:00+11:00" pubdate data-updated="true">Feb 17<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Getting this error from my server code which uses boto to interace with Dynamo</p>

<pre><code>   [Mon Feb 16 07:25:22 2015] [error] JSONResponseError: JSONResponseError: 400 Bad Request
   [Mon Feb 16 07:25:22 2015] [error] {u'message': u'Signature expired: 20150216T072522Z is now earlier than 20150216T07252
   2Z (20150216T074022Z - 15 min.)', u'__type': u'com.amazon.coral.service#InvalidSignatureException'}
</code></pre>

<p>The server is a <strong>Window Server 2012 Standard</strong> box</p>

<p>Reboot the box fixed the problem</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/post/2015/02/16/it-happens-too-often/">It Happens Too Often</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-16T10:14:00+11:00" pubdate data-updated="true">Feb 16<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The provisioning failed a few times this morning:</p>

<pre><code>   Reading state information...
   The following extra packages will be installed:
     patch
   Suggested packages:
     diffutils-doc policykit-1
   The following NEW packages will be installed:
     patch update-notifier-common
   0 upgraded, 2 newly installed, 0 to remove and 0 not upgraded.
   Need to get 248 kB of archives.
   After this operation, 2,361 kB of additional disk space will be used.
   Err http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main patch amd64 2.7.1-4ubuntu1
     Could not resolve 'us.archive.ubuntu.com'
   Err http://us.archive.ubuntu.com/ubuntu/ trusty/main update-notifier-common all 0.154.1
     Could not resolve 'us.archive.ubuntu.com'
   STDERR: E: Failed to fetch http://us.archive.ubuntu.com/ubuntu/pool/main/p/patch/patch_2.7.1-4ubuntu1_amd64.deb  Could not resolve 'us.archive.ubuntu.com'

   E: Failed to fetch http://us.archive.ubuntu.com/ubuntu/pool/main/u/update-notifier/update-notifier-common_0.154.1_all.deb  Could not resolve 'us.archive.ubuntu.com'
</code></pre>

<p>But when I ping the server, it responds perfectly.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/post/2015/02/16/setting-value-in-chef-cooking/">Setting Value in Chef Cooking</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-16T08:47:00+11:00" pubdate data-updated="true">Feb 16<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you set a variable this way in a cookbook:</p>

<pre><code>node['mysqld']['root_password'] = 'password'
</code></pre>

<p>you will get this exception</p>

<pre><code>   Chef::Exceptions::ImmutableAttributeModification
   ------------------------------------------------
   Node attributes are read-only when you do not specify which precedence level to set. To set an attribute use code like `node.default["key"] = "value"'
</code></pre>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/post/page/6/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/post/page/4/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/post/2015/03/02/how-to-identify-and-kill-session/">How to identify and kill process spawned by a tmux session?</a>
      </li>
    
      <li class="post">
        <a href="/post/2015/03/02/lesson-from-vagrant/">Lesson from learning to use vagrant, chef and sensu</a>
      </li>
    
      <li class="post">
        <a href="/post/2015/02/28/how-to-get-sensu-hipchat-plugin-to-work/">how to get sensu hipchat plugin to work</a>
      </li>
    
      <li class="post">
        <a href="/post/2015/02/28/sudo-and-glob/">sudo and glob</a>
      </li>
    
      <li class="post">
        <a href="/post/2015/02/27/using-chef-sudo-cookbook/">Using chef sudo cookbook</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("kongakong", 5, true);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <p>Follow <a href="http://twitter.com/kongakong">@kongakong</a></p>
  
</section>

<section>
  <h1>About Me</h1>
  <p>Python Developer</p>
</section>

<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/107508522522146376690?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Anthony Kong -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  








  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>

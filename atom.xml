<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Timeline]]></title>
  <link href="http://www.ahwkong.com/atom.xml" rel="self"/>
  <link href="http://www.ahwkong.com/"/>
  <updated>2015-02-15T17:29:19+11:00</updated>
  <id>http://www.ahwkong.com/</id>
  <author>
    <name><![CDATA[Anthony Kong]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[chef: cookbook php needs version number]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/15/chef-cookbook-php-needs-version-number/"/>
    <updated>2015-02-15T14:27:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/15/chef-cookbook-php-needs-version-number</id>
    <content type="html"><![CDATA[<p>In my <code>recipes\default.rb</code>, I added a line</p>

<pre><code>       package "php"
</code></pre>

<p>And this caused this exception:</p>

<pre><code>       * No version specified, and no candidate version available for php
       ================================================================================
       Error executing action `install` on resource 'apt_package[php]'
       ================================================================================

       Chef::Exceptions::Package
       -------------------------
       No version specified, and no candidate version available for php
</code></pre>

<p>I should use <code>package "php5"</code></p>

<p>Now I am getting a different set of errors:</p>

<pre><code>       * apt_package[php5] action install

       ================================================================================
       Error executing action `install` on resource 'apt_package[php5]'
       ================================================================================

       Mixlib::ShellOut::ShellCommandFailed
       ------------------------------------
       Expected process to exit with [0], but received '100'
       ---- Begin output of apt-get -q -y install php5=5.5.9+dfsg-1ubuntu4.4 ----
       STDOUT: Reading package lists...
       Building dependency tree...
       Reading state information...
       The following extra packages will be installed:
         apache2 apache2-bin apache2-data libapache2-mod-php5 libapr1 libaprutil1
         libaprutil1-dbd-sqlite3 libaprutil1-ldap php5-cli php5-common php5-json
         php5-readline ssl-cert
       Suggested packages:
         www-browser apache2-doc apache2-suexec-pristine apache2-suexec-custom
         apache2-utils php-pear php5-user-cache openssl-blacklist
       The following NEW packages will be installed:
         apache2 apache2-bin apache2-data libapache2-mod-php5 libapr1 libaprutil1
         libaprutil1-dbd-sqlite3 libaprutil1-ldap php5 php5-cli php5-common php5-json
         php5-readline ssl-cert
       0 upgraded, 14 newly installed, 0 to remove and 0 not upgraded.
       Need to get 6,137 kB of archives.
       After this operation, 25.8 MB of additional disk space will be used.
       Err http://us.archive.ubuntu.com/ubuntu/ trusty/main libapr1 amd64 1.5.0-1
         Could not resolve 'us.archive.ubuntu.com'
       Err http://us.archive.ubuntu.com/ubuntu/ trusty/main libaprutil1 amd64 1.5.3-1
         Could not resolve 'us.archive.ubuntu.com'
       Err http://us.archive.ubuntu.com/ubuntu/ trusty/main php5-json amd64 1.3.2-2build1
         Could not resolve 'us.archive.ubuntu.com'
       Err http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main php5-common amd64 5.5.9+dfsg-1ubuntu4.4
         Could not resolve 'us.archive.ubuntu.com'
       Err http://us.archive.ubuntu.com/ubuntu/ trusty/main libaprutil1-dbd-sqlite3 amd64 1.5.3-1
         Could not resolve 'us.archive.ubuntu.com'
       Err http://us.archive.ubuntu.com/ubuntu/ trusty/main libaprutil1-ldap amd64 1.5.3-1
         Could not resolve 'us.archive.ubuntu.com'
       Err http://us.archive.ubuntu.com/ubuntu/ trusty/main ssl-cert all 1.0.33
         Could not resolve 'us.archive.ubuntu.com'
       Err http://security.ubuntu.com/ubuntu/ trusty-security/main php5-common amd64 5.5.9+dfsg-1ubuntu4.4
         Could not resolve 'security.ubuntu.com'
       Err http://security.ubuntu.com/ubuntu/ trusty-security/main php5-cli amd64 5.5.9+dfsg-1ubuntu4.4
         Could not resolve 'security.ubuntu.com'
       Err http://security.ubuntu.com/ubuntu/ trusty-security/main php5-readline amd64 5.5.9+dfsg-1ubuntu4.4
         Could not resolve 'security.ubuntu.com'
       Err http://security.ubuntu.com/ubuntu/ trusty-security/main apache2-bin amd64 2.4.7-1ubuntu4.1
         Could not resolve 'security.ubuntu.com'
       Err http://security.ubuntu.com/ubuntu/ trusty-security/main apache2-data all 2.4.7-1ubuntu4.1
         Could not resolve 'security.ubuntu.com'
       Err http://security.ubuntu.com/ubuntu/ trusty-security/main apache2 amd64 2.4.7-1ubuntu4.1
         Could not resolve 'security.ubuntu.com'
       Err http://security.ubuntu.com/ubuntu/ trusty-security/main libapache2-mod-php5 amd64 5.5.9+dfsg-1ubuntu4.4
         Could not resolve 'security.ubuntu.com'
       Err http://security.ubuntu.com/ubuntu/ trusty-security/main php5 all 5.5.9+dfsg-1ubuntu4.4
         Could not resolve 'security.ubuntu.com'
       STDERR: E: Failed to fetch http://us.archive.ubuntu.com/ubuntu/pool/main/a/apr/libapr1_1.5.0-1_amd64.deb  Could not resolve 'us.archive.ubuntu.com'

       E: Failed to fetch http://us.archive.ubuntu.com/ubuntu/pool/main/a/apr-util/libaprutil1_1.5.3-1_amd64.deb  Could not resolve 'us.archive.ubuntu.com'

       E: Failed to fetch http://us.archive.ubuntu.com/ubuntu/pool/main/p/php-json/php5-json_1.3.2-2build1_amd64.deb  Could not resolve 'us.archive.ubuntu.com'

       E: Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/p/php5/php5-common_5.5.9+dfsg-1ubuntu4.4_amd64.deb  Could not resolve 'security.ubuntu.com'

       E: Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/p/php5/php5-cli_5.5.9+dfsg-1ubuntu4.4_amd64.deb  Could not resolve 'security.ubuntu.com'

   ntu4.4_amd64.deb  Could not resolve 'security.ubuntu.com'

       E: Failed to fetch http://us.archive.ubuntu.com/ubuntu/pool/main/a/apr-util/libaprutil1-dbd-sqlite3_1.5.3-1_amd64.deb  Could not resolve 'us.archive.ubuntu.com'

       E: Failed to fetch http://us.archive.ubuntu.com/ubuntu/pool/main/a/apr-util/libaprutil1-ldap_1.5.3-1_amd64.deb  Could not resolve 'us.archive.ubuntu.com'

       E: Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-bin_2.4.7-1ubuntu4.1_amd64.deb  Could not resolve 'security.ubuntu.com'

       E: Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2-data_2.4.7-1ubuntu4.1_all.deb  Could not resolve 'security.ubuntu.com'

       E: Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/a/apache2/apache2_2.4.7-1ubuntu4.1_amd64.deb  Could not resolve 'security.ubuntu.com'

       E: Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/p/php5/libapache2-mod-php5_5.5.9+dfsg-1ubuntu4.4_amd64.deb  Could not resolve 'security.ubuntu.com'



       E: Failed to fetch http://us.archive.ubuntu.com/ubuntu/pool/main/s/ssl-cert/ssl-cert_1.0.33_all.deb  Could not resolve 'us.archive.ubuntu.com'

       E: Unable to fetch some archives, maybe run apt-get update or try with --fix-missing?
       ---- End output of apt-get -q -y install php5=5.5.9+dfsg-1ubuntu4.4 ----
       Ran apt-get -q -y install php5=5.5.9+dfsg-1ubuntu4.4 returned 100


       ---------------------
       # In /tmp/kitchen/cache/cookbooks/zeeting-analytics/recipes/default.rb

         9: package "php5"
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[kitchen converge creates two VMs]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/14/kitchen-converge-creates-two-vms/"/>
    <updated>2015-02-14T18:17:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/14/kitchen-converge-creates-two-vms</id>
    <content type="html"><![CDATA[<p>It is because in .kitchen.yml, it contains these two lines:</p>

<pre><code>    platforms:
      - name: ubuntu-12.04
      - name: centos-6.5 
</code></pre>

<p>I can either specify the partform every time I use the kitchen command or simply remove the platform that I do not need.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[error running the motd example of the chef book]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/14/error-running-the-motd-example-of-the-chef-book/"/>
    <updated>2015-02-14T15:27:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/14/error-running-the-motd-example-of-the-chef-book</id>
    <content type="html"><![CDATA[<p>I am following the chapter &ldquo;Your First Cookbook: Message of the Day&rdquo; from <code>Learning Chef</code> by Mischa Taylor</p>

<p>When I run <code>kitchen converge</code>, I got these error messages:</p>

<pre><code>               ================================================================================
               Error executing action `create` on resource 'cookbook_file[/etc/motd]'
               ================================================================================

               Chef::Exceptions::FileNotFound
               ------------------------------
               Cookbook 'motd' (0.1.0) does not contain a file at any of these locations:
                 files/ubuntu-12.04/motd
                 files/ubuntu/motd
                 files/default/motd
                 files/motd

               Resource Declaration:
               ---------------------
               # In /tmp/kitchen/cookbooks/motd/recipes/default.rb

                 9: cookbook_file "/etc/motd" do
                10:   source "motd"
                11:   mode "0644"
                12: end

               Compiled Resource:
               ------------------
               # Declared in /tmp/kitchen/cookbooks/motd/recipes/default.rb:9:in `from_file'

               cookbook_file("/etc/motd") do
                 provider Chef::Provider::CookbookFile
                 action "create"
                 retries 0
                 retry_delay 2
                 default_guard_interpreter :default
                 path "/etc/motd"
                 backup 5
                 atomic_update true
                 source "motd"
                 declared_type :cookbook_file
                 cookbook_name :motd
                 recipe_name "default"
                 mode "0644"
               end


           Running handlers:
           [2015-02-14T04:22:29+00:00] ERROR: Running exception handlers
           Running handlers complete
           [2015-02-14T04:22:29+00:00] ERROR: Exception handlers complete
           [2015-02-14T04:22:29+00:00] FATAL: Stacktrace dumped to /tmp/kitchen/cache/chef-stacktrace.out
           Chef Client failed. 0 resources updated in 11.010074864 seconds
           [2015-02-14T04:22:29+00:00] ERROR: cookbook_file[/etc/motd] (motd::default line 9) had an error: Chef::Exceptions::FileNotFound: Cookbook 'motd' (0.1.0) does not contain a file at any of these locations:
             files/ubuntu-12.04/motd
             files/ubuntu/motd
             files/default/motd
      1 Hello, world
             files/motd
           [2015-02-14T04:22:29+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
</code></pre>

<p>It is because I forgot to create the file <code>files/default/motd</code></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[kitchen converge problem 2]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/14/kitchen-converge-problem-2/"/>
    <updated>2015-02-14T15:07:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/14/kitchen-converge-problem-2</id>
    <content type="html"><![CDATA[<p>Trying the <code>kitchen</code> command again, and I am still getting error messages</p>

<pre><code>    $ kitchen converge
    -----&gt; Starting Kitchen (v1.3.1)
    -----&gt; Creating &lt;default-ubuntu-1204&gt;...
           Bringing machine 'default' up with 'virtualbox' provider...
           The following berks command failed to execute:

               /Users/antkong/.rvm/gems/ruby-2.2.0/bin/berks --version --format json

           The stdout and stderr are shown below:
</code></pre>

<p>It seems like if I make sure the <code>chefdk</code> is at the beginning of the <code>PATH</code>, the above issue will go away too. e.g.</p>

<pre><code>export PATH=/Users/antkong/.chefdk/gem/ruby/2.1.0/bin:/Users/antkong/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin:/Users/antkong/.rvm/gems/ruby-2.2.0/bin
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A successful run of kitchen init]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/14/a-successful-run-of-kitchen-init/"/>
    <updated>2015-02-14T14:57:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/14/a-successful-run-of-kitchen-init</id>
    <content type="html"><![CDATA[<pre><code>    $ kitchen init --gem-file
       identical  .kitchen.yml
    Successfully installed kitchen-vagrant-0.15.0
    Parsing documentation for kitchen-vagrant-0.15.0
    Installing ri documentation for kitchen-vagrant-0.15.0
    Done installing documentation for kitchen-vagrant after 0 seconds
    1 gem installed
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[berkshelf problem with kitchen converge]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/14/berkfile-problem/"/>
    <updated>2015-02-14T12:44:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/14/berkfile-problem</id>
    <content type="html"><![CDATA[<p>My <code>kitchen converge</code> throws a lot of error message</p>

<pre><code>    $ kitchen converge
    -----&gt; Starting Kitchen (v1.3.1)

    ....

    &gt;&gt;&gt;&gt;&gt;&gt; ------Exception-------
    &gt;&gt;&gt;&gt;&gt;&gt; Class: Kitchen::ActionFailed
    &gt;&gt;&gt;&gt;&gt;&gt; Message: Failed to complete #create action: [Expected process to exit with [0], but received '1'
    ---- Begin output of vagrant up --no-provision --provider=virtualbox ----
    STDOUT: Bringing machine 'default' up with 'virtualbox' provider...
    ==&gt; default: Box 'opscode-ubuntu-12.04' could not be found. Attempting to find and install...
        default: Box Provider: virtualbox
        default: Box Version: &gt;= 0
    ==&gt; default: Adding box 'opscode-ubuntu-12.04' (v0) for provider: virtualbox
        default: Downloading: https://opscode-vm-bento.s3.amazonaws.com/vagrant/virtualbox/opscode_ubuntu-12.04_chef-provisionerless.box
    ==&gt; default: Successfully added box 'opscode-ubuntu-12.04' (v0) for 'virtualbox'!
    STDERR: The following berks command failed to execute:

        /Users/antkong/.rvm/gems/ruby-2.2.0/bin/berks --version --format json

    The stdout and stderr are shown below:

        stdout:
        stderr: /Users/antkong/.rvm/rubies/ruby-2.2.0/lib/ruby/2.2.0/rubygems/dependency.rb:315:in `to_specs': Could not find 'berkshelf' (&gt;= 0) among 122 total gem(s) (Gem::LoadError)
    Checked in 'GEM_PATH=/Users/antkong/.vagrant.d/gems:/opt/vagrant/bin/../embedded/gems', execute `gem env` for more information
      from /Users/antkong/.rvm/rubies/ruby-2.2.0/lib/ruby/2.2.0/rubygems/dependency.rb:324:in `to_spec'
      from /Users/antkong/.rvm/rubies/ruby-2.2.0/lib/ruby/2.2.0/rubygems/core_ext/kernel_gem.rb:64:in `gem'
      from /Users/antkong/.rvm/gems/ruby-2.2.0/bin/berks:22:in `&lt;main&gt;'


    It appears that you are not using the ChefDK. Please note that Vagrant Berkshelf
    works best when used with the ChefDK, and other installation methods are not
    officially supported.

    Please download and install the latest version of the ChefDK from:

        https://downloads.getchef.com/chef-dk

    and follow the installation instructions. Do not forget to add the ChefDK to
    your PATH.
    ---- End output of vagrant up --no-provision --provider=virtualbox ----
    Ran vagrant up --no-provision --provider=virtualbox returned 1]
    &gt;&gt;&gt;&gt;&gt;&gt; ----------------------
    &gt;&gt;&gt;&gt;&gt;&gt; Please see .kitchen/logs/kitchen.log for more details
    &gt;&gt;&gt;&gt;&gt;&gt; Also try running `kitchen diagnose --all` for configuration
</code></pre>

<p>It is related to the active <code>rvm</code>. Once I run <code>rvm use system</code>, the problem is resolved.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[strange gem install error]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/14/strange-gem-install-error/"/>
    <updated>2015-02-14T10:49:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/14/strange-gem-install-error</id>
    <content type="html"><![CDATA[<p>For some reason I got this error last night when I tried to run <code>gem install berkshelf</code></p>

<pre><code>    $ gem install berkshelf
    ERROR:  While executing gem ... (Errno::EHOSTDOWN)
        Host is down - sendto(2) for "10.0.1.4" port 53
</code></pre>

<p>It is apparently OK today:</p>

<pre><code>    $ gem install berkshelf
    Fetching: nio4r-1.1.0.gem (100%)
    Building native extensions.  This could take a while...
    Successfully installed nio4r-1.1.0
    Fetching: celluloid-io-0.16.2.gem (100%)
    Successfully installed celluloid-io-0.16.2
    Fetching: addressable-2.3.7.gem (100%)
    Successfully installed addressable-2.3.7
    Fetching: multipart-post-2.0.0.gem (100%)
    Successfully installed multipart-post-2.0.0
    Fetching: faraday-0.9.1.gem (100%)
    Successfully installed faraday-0.9.1
    Fetching: sawyer-0.6.0.gem (100%)
    Successfully installed sawyer-0.6.0
    Fetching: octokit-3.7.1.gem (100%)
    Successfully installed octokit-3.7.1
    Fetching: dep-selector-libgecode-1.0.2.gem (100%)
    Building native extensions.  This could take a while...
    Successfully installed dep-selector-libgecode-1.0.2
    Fetching: dep_selector-1.0.3.gem (100%)
    Building native extensions.  This could take a while...
    Successfully installed dep_selector-1.0.3
    Fetching: semverse-1.2.1.gem (100%)
    Successfully installed semverse-1.2.1
    Fetching: solve-1.2.1.gem (100%)
    Successfully installed solve-1.2.1
    Fetching: retryable-2.0.1.gem (100%)
    Successfully installed retryable-2.0.1
    Fetching: net-http-persistent-2.9.4.gem (100%)
    Successfully installed net-http-persistent-2.9.4
    Fetching: mixlib-log-1.6.0.gem (100%)
    Successfully installed mixlib-log-1.6.0
    Fetching: mixlib-authentication-1.3.0.gem (100%)
    Successfully installed mixlib-authentication-1.3.0
    Fetching: hashie-2.1.2.gem (100%)
    Successfully installed hashie-2.1.2
    Fetching: buff-ruby_engine-0.1.0.gem (100%)
    Successfully installed buff-ruby_engine-0.1.0
    Fetching: buff-shell_out-0.2.0.gem (100%)
    Successfully installed buff-shell_out-0.2.0
    Fetching: buff-ignore-1.1.1.gem (100%)
    Successfully installed buff-ignore-1.1.1
    Fetching: buff-extensions-1.0.0.gem (100%)
    Successfully installed buff-extensions-1.0.0
    Fetching: varia_model-0.4.0.gem (100%)
    Successfully installed varia_model-0.4.0
    Fetching: buff-config-1.0.1.gem (100%)
    Successfully installed buff-config-1.0.1
    Fetching: ridley-4.1.2.gem (100%)
    Successfully installed ridley-4.1.2
    Fetching: minitar-0.5.4.gem (100%)
    Successfully installed minitar-0.5.4
    Fetching: cleanroom-1.0.0.gem (100%)
    Successfully installed cleanroom-1.0.0
    Fetching: berkshelf-api-client-1.2.1.gem (100%)
    Successfully installed berkshelf-api-client-1.2.1
    Fetching: berkshelf-3.2.3.gem (100%)
    Successfully installed berkshelf-3.2.3
    Parsing documentation for nio4r-1.1.0
    Installing ri documentation for nio4r-1.1.0
    Parsing documentation for celluloid-io-0.16.2
    Installing ri documentation for celluloid-io-0.16.2
    Parsing documentation for addressable-2.3.7
    Installing ri documentation for addressable-2.3.7
    invalid options: -SHN
    (invalid options are ignored)
    Parsing documentation for multipart-post-2.0.0
    Installing ri documentation for multipart-post-2.0.0
    Parsing documentation for faraday-0.9.1
    Installing ri documentation for faraday-0.9.1
    Parsing documentation for sawyer-0.6.0
    Installing ri documentation for sawyer-0.6.0
    Parsing documentation for octokit-3.7.1
    Installing ri documentation for octokit-3.7.1
    Parsing documentation for dep-selector-libgecode-1.0.2
    unable to convert "\xEB" from ASCII-8BIT to UTF-8 for ext/libgecode3/vendor/gecode-3.7.3/changelog.in, skipping
    unable to convert "\x8E" from ASCII-8BIT to UTF-8 for ext/libgecode3/vendor/gecode-3.7.3/contribs/qecode/QCOPPlus.cc, skipping
    unable to convert "\xFC" from ASCII-8BIT to UTF-8 for ext/libgecode3/vendor/gecode-3.7.3/examples/bin-packing.cpp, skipping
    unable to convert "\xEA" from ASCII-8BIT to UTF-8 for ext/libgecode3/vendor/gecode-3.7.3/examples/black-hole.cpp, skipping
    unable to convert "\xD6" from ASCII-8BIT to UTF-8 for ext/libgecode3/vendor/gecode-3.7.3/examples/dominating-queens.cpp, skipping
    unable to convert "\xEF" from ASCII-8BIT to UTF-8 for ext/libgecode3/vendor/gecode-3.7.3/gecode.m4, skipping
    unable to convert "\xED" from ASCII-8BIT to UTF-8 for ext/libgecode3/vendor/gecode-3.7.3/gecode/int.hh, skipping
    unable to convert "\xED" from ASCII-8BIT to UTF-8 for ext/libgecode3/vendor/gecode-3.7.3/gecode/int/cumulative.hh, skipping
    unable to convert "\xE9" from ASCII-8BIT to UTF-8 for ext/libgecode3/vendor/gecode-3.7.3/gecode/int/distinct.hh, skipping
    unable to convert "\xF3" from ASCII-8BIT to UTF-8 for ext/libgecode3/vendor/gecode-3.7.3/gecode/int/gcc.hh, skipping
    unable to convert "\xE4" from ASCII-8BIT to UTF-8 for ext/libgecode3/vendor/gecode-3.7.3/gecode/int/sorted.hh, skipping
    unable to convert "\xED" from ASCII-8BIT to UTF-8 for ext/libgecode3/vendor/gecode-3.7.3/gecode/int/unary.hh, skipping
    unable to convert "\xED" from ASCII-8BIT to UTF-8 for lib/dep-selector-libgecode/vendored-gecode/include/gecode/int.hh, skipping
    unable to convert "\xED" from ASCII-8BIT to UTF-8 for lib/dep-selector-libgecode/vendored-gecode/include/gecode/int/cumulative.hh, skipping
    unable to convert "\xE9" from ASCII-8BIT to UTF-8 for lib/dep-selector-libgecode/vendored-gecode/include/gecode/int/distinct.hh, skipping
    unable to convert "\xF3" from ASCII-8BIT to UTF-8 for lib/dep-selector-libgecode/vendored-gecode/include/gecode/int/gcc.hh, skipping
    unable to convert "\xE4" from ASCII-8BIT to UTF-8 for lib/dep-selector-libgecode/vendored-gecode/include/gecode/int/sorted.hh, skipping
    unable to convert "\xED" from ASCII-8BIT to UTF-8 for lib/dep-selector-libgecode/vendored-gecode/include/gecode/int/unary.hh, skipping
    Installing ri documentation for dep-selector-libgecode-1.0.2
    Parsing documentation for dep_selector-1.0.3
    Installing ri documentation for dep_selector-1.0.3
    Parsing documentation for semverse-1.2.1
    Installing ri documentation for semverse-1.2.1
    Parsing documentation for solve-1.2.1
    Installing ri documentation for solve-1.2.1
    Parsing documentation for retryable-2.0.1
    Installing ri documentation for retryable-2.0.1
    Parsing documentation for net-http-persistent-2.9.4
    Installing ri documentation for net-http-persistent-2.9.4
    Parsing documentation for mixlib-log-1.6.0
    Installing ri documentation for mixlib-log-1.6.0
    Parsing documentation for mixlib-authentication-1.3.0
    Installing ri documentation for mixlib-authentication-1.3.0
    Parsing documentation for hashie-2.1.2
    Installing ri documentation for hashie-2.1.2
    Parsing documentation for buff-ruby_engine-0.1.0
    Installing ri documentation for buff-ruby_engine-0.1.0
    Parsing documentation for buff-shell_out-0.2.0
    Installing ri documentation for buff-shell_out-0.2.0
    Parsing documentation for buff-ignore-1.1.1
    Installing ri documentation for buff-ignore-1.1.1
    Parsing documentation for buff-extensions-1.0.0
    Installing ri documentation for buff-extensions-1.0.0
    Parsing documentation for varia_model-0.4.0
    Installing ri documentation for varia_model-0.4.0
    Parsing documentation for buff-config-1.0.1
    Installing ri documentation for buff-config-1.0.1
    Parsing documentation for ridley-4.1.2
    Installing ri documentation for ridley-4.1.2
    Parsing documentation for minitar-0.5.4
    Installing ri documentation for minitar-0.5.4
    Parsing documentation for cleanroom-1.0.0
    Installing ri documentation for cleanroom-1.0.0
    Parsing documentation for berkshelf-api-client-1.2.1
    Installing ri documentation for berkshelf-api-client-1.2.1
    Parsing documentation for berkshelf-3.2.3
    Installing ri documentation for berkshelf-3.2.3
    Done installing documentation for nio4r, celluloid-io, addressable, multipart-post, faraday, sawyer, octokit, dep-selector-libgecode, dep_selector, semverse, solve, retryable, net-http-persistent, mixlib-log, mixlib-authentication, hashie, buff-ruby_engine, buff-shell_out, buff-ignore, buff-extensions, varia_model, buff-config, ridley, minitar, cleanroom, berkshelf-api-client, berkshelf after 17 seconds
    27 gems installed
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Two way to create chef cookbooks]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/14/two-way-to-create-chef-cookbooks/"/>
    <updated>2015-02-14T01:49:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/14/two-way-to-create-chef-cookbooks</id>
    <content type="html"><![CDATA[<p>lets say we want to create a cookbook called <code>example</code></p>

<p>Method 1)</p>

<pre><code> chef generate cookbook example
</code></pre>

<p>Method 2)</p>

<pre><code>knife cookbook create example --cookbook-path .
cd example
kitchen init --create-gemfile
bundle install
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[generate public key fingerprint]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/14/generate-public-key-fingerprint/"/>
    <updated>2015-02-14T01:28:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/14/generate-public-key-fingerprint</id>
    <content type="html"><![CDATA[<p>This is the command:</p>

<pre><code>ssh-keygen -lf /path/to/ssh/public_key
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ssh forwarding in vagrant and private github repository]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/13/ssh-forwarding/"/>
    <updated>2015-02-13T16:23:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/13/ssh-forwarding</id>
    <content type="html"><![CDATA[<p>It is how to checkout git private repository from within a VM without leaving a key in the VM</p>

<p>First in host OS (Mac OSX in my case), run</p>

<pre><code>ssd-add /path/to/githubkey
</code></pre>

<p>In the <code>.ssh/config</code>, add these lines:</p>

<pre><code>    Host           github
    HostName       github.com
    IdentityFile   /path/to/githubkey
</code></pre>

<p>Then enable port forwarding in vagrant VM</p>

<pre><code>Vagrant.configure("2") do |config|
  config.ssh.forward_agent = true
</code></pre>

<p>After you have run <code>vagrant up</code>, you can test the connection in the VM by running</p>

<pre><code>ssh -T git@github.com
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[nosetests --failed keeps picking up removed test]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/13/nosetests-failed-keeps-picking-up-removed-test/"/>
    <updated>2015-02-13T11:38:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/13/nosetests-failed-keeps-picking-up-removed-test</id>
    <content type="html"><![CDATA[<p>When I run</p>

<pre><code>nosetests -v --failed
</code></pre>

<p>I keep getting this exception:</p>

<pre><code>    #40 Failure: ImportError (No module named test_share_link2) ... ERROR

    ======================================================================
    ERROR: Failure: ImportError (No module named test_share_link2)
    ----------------------------------------------------------------------
    Traceback (most recent call last):
      File "/Users/antkong/dev/project/project-ve/lib/python2.7/site-packages/nose/loader.py", line 414, in loadTestsFromName
        addr.filename, addr.module)
      File "/Users/antkong/dev/project/project-ve/lib/python2.7/site-packages/nose/importer.py", line 47, in importFromPath
        return self.importFromDir(dir_path, fqname)
      File "/Users/antkong/dev/project/project-ve/lib/python2.7/site-packages/nose/importer.py", line 79, in importFromDir
        fh, filename, desc = find_module(part, path)
    ImportError: No module named test_share_link2
</code></pre>

<p>But I have already removed this test including both py and pyc files. Why nosetests keeps picking up this test?</p>

<p>It turns out I need to remove the <code>.noseids</code> file. It contains a stale reference to the removed file</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Providing mysqld password to chef provisioner in vagrant]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/11/mysqld-password-and-chef/"/>
    <updated>2015-02-11T05:04:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/11/mysqld-password-and-chef</id>
    <content type="html"><![CDATA[<p>I add a chef <code>mysqld</code> receipt to the Vagrant file and here is the error from <code>vagrant up</code>:</p>

<pre><code>    ==&gt; default: Required argument password is missing!
    ==&gt; default:
    ==&gt; default: Cookbook Trace:
    ==&gt; default: ---------------
    ==&gt; default:   /tmp/vagrant-chef/3aa2e36871bb373e4212367ce1b7d9af/cookbooks/mysqld/recipes/configure.rb:26:in `block in from_file'
    ==&gt; default:   /tmp/vagrant-chef/3aa2e36871bb373e4212367ce1b7d9af/cookbooks/mysqld/recipes/configure.rb:25:in `from_file'
    ==&gt; default:   /tmp/vagrant-chef/3aa2e36871bb373e4212367ce1b7d9af/cookbooks/mysqld/recipes/default.rb:22:in `from_file'
    ==&gt; default:
    ==&gt; default: Relevant File Content:
    ==&gt; default: ----------------------
    ==&gt; default: /tmp/vagrant-chef/3aa2e36871bb373e4212367ce1b7d9af/cookbooks/mysqld/recipes/configure.rb:
    ==&gt; default:
    ==&gt; default:  19:  #
    ==&gt; default:  20:
    ==&gt; default:
    ==&gt; default:  21:  # Configure mysql/mariadb according to attributes
    ==&gt; default:  22:  mysqld 'default'
    ==&gt; default:  23:
    ==&gt; default:  24:  # Set password according to attribute, if set
    ==&gt; default:  25:  mysqld_password 'root' do
    ==&gt; default:  26&gt;&gt;   password node['mysqld']['root_password']
    ==&gt; default:
    ==&gt; default:  27:    only_if { node['mysqld']['root_password'] }
    ==&gt; default:  28:  end
    ==&gt; default:  29:
</code></pre>

<p>Solution: Add this to set the <code>root_password</code>:</p>

<pre><code>chef.json = {
  :mysqld   =&gt; {
    :root_password =&gt; "test"
  }
}
</code></pre>

<p>Now you can connect to the mysql server by running</p>

<pre><code> mysql -u root -p 
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Cannot find a resource matching ruby_block[sensu_service_trigger]]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/08/cannot-find-a-resource-matching-ruby-block-sensu-service-trigger/"/>
    <updated>2015-02-08T18:26:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/08/cannot-find-a-resource-matching-ruby-block-sensu-service-trigger</id>
    <content type="html"><![CDATA[<p>This the error message:</p>

<pre><code>    ==&gt; default: ================================================================================
    ==&gt; default: Error executing action `enable` on resource 'sensu_service[sensu-client]'
    ==&gt; default: ================================================================================
    ==&gt; default:
    ==&gt; default: Chef::Exceptions::ResourceNotFound
    ==&gt; default: ----------------------------------
    ==&gt; default: Cannot find a resource matching ruby_block[sensu_service_trigger] (did you define it first?)
    ==&gt; default:
    ==&gt; default: Cookbook Trace:
    ==&gt; default: ---------------
    ==&gt; default: /tmp/vagrant-chef/c66d06dac7e6e1e4d559122d4d1a9f5c/cookbooks/sensu/providers/service.rb:52:in `block in load_current_resource'
</code></pre>

<p>It is because I did not include the <code>sensu::default</code> cookbook.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[brew and cast]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/08/brew-and-cast/"/>
    <updated>2015-02-08T10:58:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/08/brew-and-cast</id>
    <content type="html"><![CDATA[<p>Reinstalling cask on another mac. Thought it is the command to install <code>cask</code> brew subcommand:</p>

<pre><code>brew install cask
</code></pre>

<p>Wrong! This <code>cask</code> is actually an emacs package manager.</p>

<p>To install <code>brew cask</code>, it is the command:</p>

<pre><code>brew tap caskroom/cask
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ochiwa unable to connect to sensu]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/06/ochiwa-unable-to-connect-to-sensu/"/>
    <updated>2015-02-06T05:13:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/06/ochiwa-unable-to-connect-to-sensu</id>
    <content type="html"><![CDATA[<p>I used chef to install sensu and ochiwa.</p>

<p>In the ocihwa log I see a lot of &lsquo;connection refused&rsquo; error</p>

<pre><code>{"Date":"2015-02-05T09:42:23.516606749Z","Level":"warning","Src":{"Func":"github.com/sensu/uchiwa/uchiwa.Build","Line":49},"Output":"API call to \"http://127.0.0.1:4567/stashes\" returned: Get http://127.0.0.1:4567/stashes: dial tcp 127.0.0.1:4567: connection refused"}
</code></pre>

<p>With help from sensu irc chatroom, I checked</p>

<pre><code>netstat -anp | grep 4567
</code></pre>

<p>There is no process.</p>

<pre><code>service sensu-api status
</code></pre>

<p>The service is stopped.</p>

<p>After starting the service, ochiwa can talk to sensu server now.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[mandrill is sending me a strange template name]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/05/mandrill-is-sending-me-a-strange-name/"/>
    <updated>2015-02-05T13:11:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/05/mandrill-is-sending-me-a-strange-name</id>
    <content type="html"><![CDATA[<p>I have originally created a template <code>hello_world</code>. Then I renamed it to <code>sayhi</code>. Somehow the <code>Template Slug</code> stays as <code>hello-world</code>: in the webhook payload the template name carries <code>hello-world</code> instead of the new name <code>sayhi</code></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Authenticate Mandrill Webhook Call in Python]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/04/authenticate-mandrill-webhook-call/"/>
    <updated>2015-02-04T19:58:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/04/authenticate-mandrill-webhook-call</id>
    <content type="html"><![CDATA[<p>There are plenty of examples in php out there, but I cannot find any in python. I reckon I can share my implementation here.</p>

<p>It is assuming you are using Google App Engine</p>

<pre><code>    import webapp2
    import hashlib
    import hmac

    class MandrillWebhookHandler(webapp2.RequestHandler):

        def _calc_signature(self, raw, key):
            hashed = hmac.new(key, raw, hashlib.sha1)
            return hashed.digest().encode("base64").rstrip('\n')

        def verify_mandrill_signature(self):
            '''
            Mandrill includes an additional HTTP header with webhook POST requests,
                X-Mandrill-Signature, which will contain the signature for the request.
                To verify a webhook request, generate a signature using the same key
                that Mandrill uses and compare that to the value of the
                X-Mandrill-Signature header.
            :return: True if verified valid
            '''
            mandrill_signature = self.request.headers['X-Mandrill-Signature']
            mandrill_key = 'Your mandrill webhook key goes here'
            signed_data = self.request.path_url
            sorted_key = sorted(self.request.arguments())
            for k in sorted_key:
                signed_data += k
                signed_data += self.request.get(k)
            expected_signature = self._calc_signature(signed_data, mandrill_key)
            return expected_signature == mandrill_signature

        def head(self):
            '''
            Must return 200 so Mandrill knows it is a valid webhook

            http://help.mandrill.com/entries/22024856-Why-can-t-my-webhook-or-inbound-route-URL-be-verified-
            '''
            self.response.set_status(OK)

        def post(self):
            '''
            Mandrill sends data to our webhook by post
            '''
            if not self.verify_mandrill_signature():
                # check failed
                self.abort()

            # The rest of processing
            # ...
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Search for javascript code in development console in chrome]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/04/search-for-code-in-dev-console-in-chrome/"/>
    <updated>2015-02-04T14:32:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/04/search-for-code-in-dev-console-in-chrome</id>
    <content type="html"><![CDATA[<p>In OS X, do <code>cmd</code> + <code>Opt</code> + <code>F</code></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Update ChefDK in OSX]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/04/update-chefdk-in-osx/"/>
    <updated>2015-02-04T09:08:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/04/update-chefdk-in-osx</id>
    <content type="html"><![CDATA[<p>A new version of ChefDK 0.4.0 has been released. I did an upgrade via <code>brew cask</code></p>

<pre><code>    $ brew update
    ...
    $ brew cask install --force chefdk
    ==&gt; Downloading https://opscode-omnibus-packages.s3.amazonaws.com/mac_os_x/10.8/x86_64/chefdk-0.4.0-1.dmg
    ######################################################################## 100.0%
    ==&gt; Running installer for chefdk; your password may be necessary.
    ==&gt; Package installers may write to any location; options such as --appdir are ignored.
    Password:
    ==&gt; installer: Package name is Chef Development Kit
    ==&gt; installer: Upgrading at base path /
    ==&gt; installer: The upgrade was successful.
    🍺  chefdk staged at '/opt/homebrew-cask/Caskroom/chefdk/0.4.0-1' (6 files, 99M)
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[a little gotcha with @patch]]></title>
    <link href="http://www.ahwkong.com/post/2015/02/02/a-little-catch-with-at-patch/"/>
    <updated>2015-02-02T16:34:00+11:00</updated>
    <id>http://www.ahwkong.com/post/2015/02/02/a-little-catch-with-at-patch</id>
    <content type="html"><![CDATA[<p>This is my code</p>

<pre><code>from mail_api import send_mail

def my_func():
    # do some work
    send_mail(to="test@example.com", content="data)
    # do some more work
    return result
</code></pre>

<p>Here is my unit test. I want to test for the return value but I do not want to send out any email at all from the unit test. That&rsquo;s why I patch the <code>send_mail</code> function.</p>

<pre><code>from mock import patch

  class MyTest(unittest.TestCase):

    @patch('mail_api.send_mail')
    def test_my_func(self, send_mail):
      self.assertEquals(my_func(), expected_result)
</code></pre>

<p>To my surprise an email is still sent out when the test is run!</p>

<p>It turns out <code>my_func</code> still retains a reference to the original <code>send_mail</code> function. If I want to successfully patch the mail api, I need to rewrite <code>my_func</code> like this:</p>

<pre><code>import mail_api

def my_func():
    # do some work
    mail_api.send_mail(to="test@example.com", content="data)
    # do some more work
    return result
</code></pre>
]]></content>
  </entry>
  
</feed>
